#textdomain wesnoth-swamplings

[scenario]
    id=16_Full_Circle
    name= _ "Full Circle"
    map_data="{~add-ons/Swamplings/maps/PogoBog08.map}"
    {SCENARIO_MUSIC northern_mountains.ogg}
    {EXTRA_SCENARIO_MUSIC vengeful.ogg}
    {EXTRA_SCENARIO_MUSIC battle.ogg}
    turns=-1

    {DEFAULT_SCHEDULE_FIRST_WATCH}

    next_scenario=17_Credits

    {ANIMATED_CAMPFIRE 19 26}
    {ANIMATED_CAMPFIRE 14 27}
    {ANIMATED_CAMPFIRE 14 24}
    {ANIMATED_CAMPFIRE 19 31}

    [story]
        [part]
            music="heroes_rite.ogg"
            story= _ "<span color='yellow'>This morning, I dreamed I was climbing a high cliff. Terro followed behind me.
            
<i>Papa, why are we climbing? </i>he asked.
			
<i>Because I need more feathers, </i>I told him, <i>And because someday you will be chieftain and you will need feathers as well.</i>
			
Then I remembered. Terro will never be chieftain someday. Terro is dead.
			
When we reached the top of the crag we found Ronry the Healer. We found Xaztex and the Swift One and too many of my brave tribesmen who had fought by my side. And my dear Tarna, proud and bright as always.
			
And for the first time, Terro got to meet my father.
			
I would have given all I have to spend another afternoon with them. I wept, knowing I would soon awaken and they'd vanish. I cursed my life and all it meant.
			
My father took me aside and explained. <i>When you're alive you can't always see the beauty and the greatness of it all. It looks like you're going in circles. They aren't circles. That's an illusion.</i>
			
<i>Dung! </i>I screamed at him. <i>My life is dung.</i>
			
He nodded, smoking his pipe. <i>... Of course dung makes an excellent fertilizer.</i></span>"
            text_layout=middle
            [image]
                file="units/trumpeter-rope.png"
                x,y=120,75
                centered=yes
            [/image]
            background=
        [/part]
    [/story]
    [story]
        [part]
            music="calm-before-storm.ogg"
            story= _ "For the first time, the path ahead was clear. Our journey through the hill country and back to Pogo Bog was largely uneventful. Our mounted riders made excellent scouts and we found it easy to avoid the larger orc clans. Many of our tribe wanted to stay in the hills permanently, but I remembered my fatherâ€™s advice: never take a spot you cannot defend. Life in the bog was difficult, but it was safer than living next to the orcs. So it was that we returned to the spot from whence we started."
            background="maps/wesnoth.png"
            show_title=yes
            title_alignment=center
        [/part]
    [/story]

    [side]
        type=Direwolf Rider Sw
        id=Clammie
        name= _ "Clammie"
        unrenamable=yes
        profile=portraits/goblins/transparent/rouser-2.png
        side=1
        canrecruit=yes
        recruit=Vampire Bat,Goblin Spearman Sw,Wolf Rider 2Sw,Goblin Mimic,Thundergobo,Orcish Archer,Goblin Moonbeam,Swamp Wolf
        team_name=1
        user_team_name=_"Clammie and Co."
        controller=human
        animate=yes
        fog=yes
        share_view=yes
        {GOLD 600 600 500}
        [modifications]
            {TRAIT_SWAMPSAVVY}
        [/modifications]
        #		save_id="Clammie and Co."
    [/side]
    [side]
        side=2
        canrecruit=yes
#ifdef EASY
        recruit=Spearman,Sergeant,Horseman,Cavalryman
#else
        recruit=Spearman,Sergeant,Horseman,Cavalryman,Knight
#endif
        team_name=2
        type=Master at Arms
        id=Archduke
        name= _ "Archduke"
        animate=yes
        unrenamable=yes
        user_team_name=_"Archduke's Cavalry"
        ai_special=guardian
        {FLAG_VARIANT loyalist}
        {GOLD 650 650 750}
        save_id="Archduke's Forces"
    [/side]

#ifdef NORMAL
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 Knight 3}
#endif

#ifdef HARD
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 Knight 5}
#endif

    [side]
        side=3
        type=South Guard Captain
        id=Phillips
        name= _ "Phillips"
        unrenamable=yes
        canrecruit=yes
#ifdef EASY
        recruit=Spearman,Bowman,Heavy Infantryman,Fencer
#else
        recruit=Spearman,Bowman,Heavy Infantryman,Fencer,Duelist,Swordsman
#endif
        team_name=2
        user_team_name=_"Archduke's Infantry"
        profile="portraits/transparent/gerrick_HRa.png"
        [village]
            x,y=6,35
        [/village]
        {FLAG_VARIANT loyalist}
        {GOLD 650 650 750}
    [/side]
    {LIMIT_CONTEMPORANEOUS_RECRUITS 3 (Heavy Infantryman) 5}

#ifdef NORMAL
    {LIMIT_CONTEMPORANEOUS_RECRUITS 3 Duelist 3}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 3 Swordsman 3}
#endif

#ifdef HARD
    {LIMIT_CONTEMPORANEOUS_RECRUITS 3 Duelist 4}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 3 Swordsman 4}
#endif

    [side]
        type=Merman Netcaster
        id=Tikitiki
        name= _ "Tikitiki"
        unrenamable=yes
        facing=nw
        side=4
        canrecruit=yes
        recruit=Merman Fighter Sw,Merman Warrior,Merman Hunter,Mermaid Initiate,Vampire Bat,Merman Spearman
        team_name=1
        user_team_name=_"Merfolk"
        ai_special=guardian
        fog=yes
        # no shared view yet, until opening conversation:
        share_view=no
        experience=$Tikitiki_xp
        # since Tikitiki was defeated in part 7, his lack of xp and empty recall list make a certain degree of sense. Any leftover gold will carry over from S7:
        persistent=1
        save_id="Merfolk"
        [ai]
            passive_leader=yes
        [/ai]
        {GOLD 300 250 200}
    [/side]

    {LIMIT_CONTEMPORANEOUS_RECRUITS 4 (Vampire Bat) 1}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 4 (Mermaid Initiate) 5}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 4 (Merman Spearman) 3}

    [side]
        type=Knight
        id=Shining
        name= _ "Knight Shining"
        side=5
        x,y=1,35
        {IS_HERO}
        [modifications]
            {TRAIT_INTELLIGENT}
            {TRAIT_QUICK}
        [/modifications]
        unrenamable=yes
        canrecruit=yes
        recruit=Woodsman
        # to avoid being killed by side 2, he's on their side for now:
        team_name=2
        user_team_name=_"Shining's Woodsmen"
        fog=yes
        share_view=yes
        ai_special=guardian
        hidden=yes
        # they get 6 free units, and Woodsmen need no upkeep, so this breaks down to 36/16/6 units depending on difficulty:
        {GOLD 180 60 0}
    [/side]

#ifdef YETI
    {YETI_SIDE}
#else
    [side]
        no_leader=yes
        side=6
        hidden=yes
        {GOLD 0 0 0}
    [/side]
#endif

    # for Grirk:
    [side]
        no_leader=yes
        side=7
        team_name=1
        controller=human
        fog=yes
        share_view=yes
        hidden=yes
        user_team_name=_"Quicksand Clan"
#ifdef EASY
        recruit=Orcish Grunt,Orcish Assassin,Goblin Spearman Sw,Orcish Warrior
#else
        recruit=Orcish Grunt,Orcish Assassin,Goblin Spearman Sw
#endif
        {FLAG_VARIANT ragged}
        {GOLD 250 200 150}
    [/side]

    [item]
        x,y=10,28
        image=scenery/village-human-burned3.png
    [/item]

    [item]
        x,y=10,23
        image=scenery/village-human-burned1.png
    [/item]

    [item]
        x,y=3,28
        image=scenery/village-human-burned4.png
    [/item]

    [item]
        x,y=12,19
        image=scenery/village-human-burned2.png
    [/item]

    [item]
        x,y=30,18
        image=scenery/village-human-burned3.png
    [/item]

    [item]
        x,y=26,16
        image=scenery/rubble.png
    [/item]

    [event]
        name=start

		# in Easy games, Clammie can recruit level 1's:
		#ifdef EASY
		{SS_TRAIT_ON_RECRUITMENT ("Goblin Impaler Sw","Goblin Rouser 2Sw")}

        [allow_recruit]
            [filter_side]
            	side=1
            [/filter_side]
            type=Goblin Impaler Sw,Goblin Rouser 2Sw
        [/allow_recruit]
		#endif

        {INCIDENTAL_MUSIC "into_the_shadows.ogg"}

        {SS_TRAIT_ON_ADVANCEMENT}
        {EEEP_MENU}
        {MISRIS_MENU}
        {MISRIS_RECRUITING_FIX}
        {DIREWOLF_ADVANCEMENT}
        {CLAMMIE_DIREWOLF_LEADER_ADVANCEMENT}
        {SS_TRAIT_ON_RECRUITMENT ("Thundergobo","Goblin Moonbeam")}

        # it's too easy with Pillagers:
        [disallow_recruit]
            [filter_side]
            	side=1
            [/filter_side]
            type=Goblin Pillager
        [/disallow_recruit]

        # in S12, Archduke could recruit Bowmen, but not this time:
        [disallow_recruit]
            [filter_side]
            	side=2
            [/filter_side]
            type=Bowman
        [/disallow_recruit]

        # keep Shining from recruiting Horsemen:
        [disallow_recruit]
            [filter_side]
            	side=5
            [/filter_side]
            type=Horseman
        [/disallow_recruit]

        # hide Shining:
        [hide_unit]
            x,y=1,35
        [/hide_unit]

        # keeps Shining from moving:
        {VARIABLE part 1}

        # fix Archduke's XP:
        [store_unit]
            variable=stored_archduke
            [filter]
                id=Archduke
            [/filter]
        [/store_unit]

        {VARIABLE stored_archduke.experience $archduke_experience}

        [unstore_unit]
            variable=stored_archduke
        [/unstore_unit]

        {CLEAR_VARIABLE stored_archduke,archduke_experience}

        # fix Phillips' XP & level:
        [store_unit]
            variable=stored_phillips
            [filter]
                id=Phillips
            [/filter]
        [/store_unit]

        {VARIABLE stored_phillips.experience $phillips_store.experience}
        {VARIABLE stored_phillips.level $phillips_store.level}

        [unstore_unit]
            variable=stored_phillips
        [/unstore_unit]

        {CLEAR_VARIABLE stored_phillips,phillips_store}

        # fix Tikitiki's XP:
        [store_unit]
            variable=stored_tiki
            [filter]
                id=Tikitiki
            [/filter]
        [/store_unit]

        {VARIABLE stored_tiki.experience $Tikitiki_xp}
        [unstore_unit]
            variable=stored_tiki
        [/unstore_unit]

        {CLEAR_VARIABLE stored_tiki,Tikitiki_xp}

        [recall]
            id=Kennison
            x,y=34,3
            show=yes
        [/recall]
        [if]
            [have_unit]
                id=Kennison
            [/have_unit]
            [else]
                [unit]
                    id=Kennison
                    name= _ "Kennison"
                    type=Bowman
                    side=1
                    x,y=34,3
                    unrenamable=yes
                    {IS_HERO}
                    profile=portraits/humans/transparent/duelist.png
                    [modifications]
                        {TRAIT_LOYAL}
                    [/modifications]
                [/unit]
                [object]
                    [filter]
                        id=Kennison
                    [/filter]
                    silent=yes
                    duration=forever
                    [effect]
                        apply_to=attack
                        range=ranged
                        [set_specials]
                            mode=append
                            {WEAPON_SPECIAL_POISON}
                        [/set_specials]
                    [/effect]
                [/object]
            [/else]
        [/if]

        # recall Eeep:
        [recall]
            id=Eeep
            x,y=33,4
            show=yes
        [/recall]
        [if]
            [have_unit]
                id=Eeep
            [/have_unit]
            [else]
                [unit]
                    id=Eeep
                    name= _ "Eeep"
                    unrenamable=yes
                    side=1
                    type=Wolf Rider Sw
                    profile="portraits/transparent/eeepwr.png"
                    [modifications]
                        {TRAIT_SWAMPSAVVY}
                        {TRAIT_DIM}
                        {TRAIT_LOYAL}
                    [/modifications]
                    {IS_HERO}
                    x,y=33,4
                    animate=yes
                [/unit]
            [/else]
        [/if]

        [recall]
            id=Headbag
            x,y=35,4
            show=yes
        [/recall]

        [recall]
            id=Greta
            x,y=32,3
            show=yes
        [/recall]

        {CLEAR_FOG_NOBUG 1 16 24 5}
        {CLEAR_FOG_NOBUG 1 16 26 5}

        {UNIT 2 Spearman 16 25 animate=yes}
        {UNIT 2 Sergeant 17 26 animate=yes}

        [message]
            speaker=Archduke
            message= _ "Welcome home, goblins."
        [/message]

        {MODIFY_UNIT id=Eeep facing sw}
        {MODIFY_UNIT id=Kennison facing sw}
        {MODIFY_UNIT id=Clammie facing sw}
        {MODIFY_UNIT id=Headbag facing sw}

        [message]
            speaker=Clammie
            message= _ "You've destroyed our home patch! Why?"
        [/message]

        [scroll_to_unit]
            id=Archduke
        [/scroll_to_unit]

        [message]
            speaker=Archduke
            message= _ "Look at yourselves, marching in with archers and riders. Do you think you can ride around on wolves and not invite a battle? It's my policy to crush any gathering of primitives near my city if it becomes too powerful. I call it my Xaffrasz policy."
        [/message]
        [message]
            speaker=Clammie
            message= _ "You no longer blame that on Francois, then?"
        [/message]

        [scroll_to_unit]
            id=Archduke
        [/scroll_to_unit]

        [message]
            speaker=Archduke
            message= _ "Officially speaking, Xaffrasz was Francois' fault. Thank you for defeating him for me, it's far easier to blame a dead man than one who can speak for himself."
        [/message]
        [message]
            speaker=Clammie
            message= _ "And who's back shall you stab next? Phillips, I suppose."
        [/message]

        [scroll_to_unit]
            id=Archduke
        [/scroll_to_unit]

        [message]
            speaker=Archduke
            message= _ "Ignore them, Phillips."
        [/message]

        {CLEAR_FOG_NOBUG 1 4 14 2}
        {MODIFY_UNIT id=Phillips facing se}

        [message]
            speaker=Phillips
            message= _ "Yes, sir."
        [/message]
        [message]
            speaker=Clammie
            message= _ "Does this policy of yours extend to the orcish tribes? And the merfolk?"
        [/message]

        [scroll_to_unit]
            id=Archduke
        [/scroll_to_unit]

        [message]
            speaker=Archduke
            message= _ "It extends to whomsoever I deem it extends to."
        [/message]

        [sound]
            name=water-blast.wav
        [/sound]

        # we now see Tikitiki:
        [modify_side]
            [filter_side]
            	side=4
            [/filter_side]
            share_view=yes
        [/modify_side]

        [message]
            speaker=Tikitiki
            message= _ "We have concluded our tour of Xaffrasz. Do you humans think you can crush us one by one?"
        [/message]

        [scroll_to_unit]
            id=Archduke
        [/scroll_to_unit]

        [message]
            speaker=Archduke
            message= _ "Return to your river, fool. I have no plans to torch your underwater city."
        [/message]
        [message]
            speaker=Tikitiki
            message= _ "I'd be a fool to expect peace from a perjurer!"
        [/message]

        {INCIDENTAL_MUSIC "northern_mountains.ogg"}

        [scroll_to_unit]
            id=Archduke
        [/scroll_to_unit]

        [message]
            speaker=Archduke
            message= _ "Do you wish to fight me here, in the wreckage of a goblin shantytown? So be it!"
        [/message]

        {CLEAR_FOG_NOBUG 1 4 2 2}

        {MOVE_UNIT id=Archduke 4 3}

        [if]
            [have_unit]
                id=Headbag
            [/have_unit]

            [then]
                [message]
                    speaker=Clammie
                    message= _ "Headbag, make for the hills! Let the orcs know they finally have a chance to face the humans! The Archduke's army will fall this day!"
                [/message]
                [message]
                    speaker=Headbag
                    message= _ "Fly, Bunnymuncher! Fly like the wind!"
                [/message]

                {STORE_UNIT_VAR x,y=35,4 id id_of_messenger}
                {STORE_UNIT_VAR x,y=35,4 name name_of_messenger}

                [sound]
                    name="wolf-die.wav"
                [/sound]

                {MOVE_UNIT id=Headbag 35 1}

                [store_unit]
                    [filter]
                        id=Headbag
                    [/filter]
                    variable=messenger
                [/store_unit]

                [kill]
                    id=Headbag
                    animate=no
                    fire_event=no
                [/kill]

                {FAKE_UNIT_MOVE 35 35 4 1 1 (messenger.type) ()}
            [/then]
            [else]
                {NAMED_UNIT 1 (Wolf Rider Sw) 35 4 Gralo (_"Gralo") (
                    unrenamable=yes
                    facing=ne
                    animate=yes
                )}

                [message]
                    speaker=Clammie
                    message= _ "Gralo, make for the hills! Let the orcs know they finally have a chance to face the humans! The Archduke's army will fall this day!"
                [/message]
                [message]
                    speaker=Gralo
                    message= _ "Fly, Bunnymuncher! Fly like the wind!"
                [/message]

                {STORE_UNIT_VAR x,y=35,4 id id_of_messenger}
                {STORE_UNIT_VAR x,y=35,4 name name_of_messenger}

                [sound]
                    name="wolf-die.wav"
                [/sound]

                [store_unit]
                    [filter]
                        id=Gralo
                    [/filter]
                    variable=messenger
                [/store_unit]

                [kill]
                    id=Gralo
                    animate=no
                    fire_event=no
                [/kill]

                {FAKE_UNIT_MOVE 35 35 4 1 1 (Wolf Rider) ()}
            [/else]
        [/if]

        {UNCLEAR_FOG_NOBUG}

        [objectives]
            [objective]
                description= _ "Defeat the Archduke"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Clammie"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Eeep"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Tikitiki"
                condition=lose
            [/objective]
        [/objectives]
    [/event]

    # keeps Shining from moving for now:
    [event]
        name=turn refresh
        first_time_only=no
        [if]
            [variable]
                name=side_number
                numerical_equals=5
            [/variable]
#            [and]
                [variable]
                    name=part
                    equals=1
                [/variable]
#            [/and]
            [then]
                {MODIFY_UNIT (id=Shining) moves 0}

                [hide_unit]
                    x,y=1,35
                [/hide_unit]
            [/then]
        [/if]
    [/event]

    [event]
        name=side 1 turn 2
        [message]
            speaker=Clammie
            message= _ "Eeep, send some riders to protect our merman ally."
        [/message]
        [message]
            speaker=Tikitiki
            message= _ "Clearly, you swamplings don't know the might of the army of Marinus!"
        [/message]
        [message]
            speaker=Eeep
            message= _ "Hey, we kicked your--"
        [/message]
        [message]
            speaker=Clammie
            message= _ "Eeep! There's no time for this diplomacy."
        [/message]
    [/event]

    # Augalol/Duldursil recall:
    [event]
        name=recall
        [filter]
            role=dwarf
        [/filter]

        [message]
            role=dwarf
            message= _ "Aaaaaaaaaaaaarrk! This blochin' bogfightin' will make me old before me time! I'm only five hundred and ought nine come Samhain!"
        [/message]
        [message]
            speaker=Clammie
            message= _ "I'd build you a canoe, but we're in the middle of being ambushed."
        [/message]
        [message]
            role=dwarf
            message= _ "You're always with an excuse, you."
        [/message]
        [message]
            speaker=Clammie
            message= _ "And gold."
        [/message]
        [message]
            role=dwarf
            message= _ "Hahaha! Yes, and gold!"
            sound=gold.ogg
        [/message]
    [/event]

    [event]
        name=side 1 turn 7

        [unstore_unit]
            variable=messenger
            x,y=35,1
        [/unstore_unit]

        {CLEAR_FOG_NOBUG 1 33 3 3}

        {MOVE_UNIT id=$id_of_messenger 34 3}

        {INCIDENTAL_MUSIC "legends_of_the_north.ogg"}
        {APPEND_MUSIC "legends_of_the_north.ogg"}

        {NAMED_UNIT 7 (Orcish Leader) 35 4 Grirk (_"Grirk") (
            profile="portraits/orcs/transparent/leader.png"
            animate=yes
            unrenamable=yes
            canrecruit=yes
        )}

        [modify_side]
            [filter_side]
            	side=7
            [/filter_side]
            hidden=no
        [/modify_side]

        {UNIT 7 (Orcish Grunt) 34 4 animate=yes}
        {UNIT 7 (Orcish Grunt) 33 4 animate=yes}

        [unstore_unit]
            variable=stored_hert
            x,y=35,3
        [/unstore_unit]

        [if]
            [have_unit]
                id=Hertrazzir
            [/have_unit]
            [then]
                [store_unit]
                    [filter]
                        id=Hertrazzir
                    [/filter]
                    variable=stored_hert
                [/store_unit]

                {VARIABLE stored_hert.side 1}
                {VARIABLE stored_hert.facing sw}
                {VARIABLE stored_hert.canrecruit no}
                {VARIABLE stored_hert.overlays "misc/hero-icon.png"}
                {VARIABLE stored_hert.hitpoints $stored_hert.max_hitpoints}

                [unstore_unit]
                    variable=stored_hert
                [/unstore_unit]

                {CLEAR_VARIABLE stored_hert}
            [/then]
            [else]
                [recall]
                    id=Zslap
                    x,y=35,3
                    show=yes
                [/recall]

                [if]
                    [have_unit]
                        id=Zslap
                    [/have_unit]
                    [then]
                        [store_unit]
                            [filter]
                                id=Zslap
                            [/filter]
                            variable=stored_zslap
                        [/store_unit]

                        {VARIABLE stored_zslap.side 1}
                        {VARIABLE stored_zslap.facing sw}
                        {VARIABLE stored_zslap.canrecruit no}
                        {VARIABLE stored_zslap.overlays "misc/hero-icon.png"}
                        {VARIABLE stored_zslap.hitpoints $stored_zslap.max_hitpoints}

                        [unstore_unit]
                            variable=stored_zslap
                        [/unstore_unit]

                        {CLEAR_VARIABLE stored_zslap}
                    [/then]

                    # Zslap should be alive in all cases, but here is a failsafe:
                    [else]
                        [unit]
                            side=1
                            type=Saurian Ambusher
                            profile=profile="portraits/transparent/inarix.png"
                            [abilities]
                                {ABILITY_LEADERSHIP_LEVEL_3}
                            [/abilities]
                            {IS_HERO}
                            x,y=35,3
                            animate=yes
                        [/unit]
                    [/else]
                [/if]
            [/else]
        [/if]

        {UNIT 1 (Saurian Skirmisher) 34 2 animate=yes}
        {UNIT 1 (Saurian Skirmisher) 35 2 animate=yes}
#ifdef EASY
        {UNIT 1 (Saurian Skirmisher) 34 1 (
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
            overlays="misc/loyal-icon.png"
            animate=yes
        )}
#endif

        [message]
            speaker=Eeep
            message= _ "$name_of_messenger is back with the orcs!"
        [/message]

        {MODIFY_UNIT id=Grirk facing sw}

        [message]
            speaker=Clammie
            message= _ "My orcish brothers, you have fought with goblins by your side in many battles. May this battle be the first step toward a deeper understanding of each other."
        [/message]
        [message]
            speaker=Grirk
            message= _ "Shaddap! We come to kill humans!"
        [/message]
        [message]
            speaker=$id_of_messenger
            message= _ "I also brought some saurians who want to poke holes in the Archduke's Xaffrasz policy."
        [/message]

        [if]
            [have_unit]
                id=Hertrazzir
            [/have_unit]
            [then]
                [message]
                    speaker=Clammie
                    message= _ "Hertrazzir!"
                [/message]
                [message]
                    speaker=Hertrazzir
                    message=_ "Those who set Xaffrasz ablaze shall pay this day!"
                    sound=hiss.wav
                [/message]
            [/then]
            [else]
                [message]
                    speaker=Zslap
                    message= _ "Those who set Xaffrasz ablaze shall pay this day!"
                    sound=hiss.wav
                [/message]
            [/else]
        [/if]

        [unstore_unit]
            variable=sydd_store
            x,y=3,2
        [/unstore_unit]

        [if]
            [have_unit]
                id=Sydd
                #			side=4
            [/have_unit]
            [then]
                {CLEAR_VARIABLE sydd_store}

                {MODIFY_UNIT id=Sydd side 2}

                {CLEAR_FOG_NOBUG 1 2 2 2}

                [message]
                    speaker=Archduke
                    message= _ "The biggest problem with these barbarians is their unwillingness to remain divided long enough for me to conquer them! Where's Sydd?"
                [/message]

                {MODIFY_UNIT id=Sydd facing se}

                [message]
                    speaker=Sydd
                    message= _ "<i>mutters</i>"
                [/message]

                {MODIFY_UNIT id=Archduke facing nw}

                [message]
                    speaker=Archduke
                    message= _ "What's that, Sydd?"
                [/message]
                [role]
                    role=Ads_toadie
                    id=Sydd
                [/role]
            [/then]
            [else]
                {NAMED_UNIT 2 Swordsman 3 2 Yryrcyn (_"Yryrcyn") (
                    unrenamable=yes
                    animate=yes
                )}

                {CLEAR_FOG_NOBUG 1 2 2 2}

                [message]
                    speaker=Archduke
                    message= _ "The biggest problem with these barbarians is their unwillingness to remain divided long enough for me to conquer them! Where's Yryrcyn?"
                [/message]

                {MODIFY_UNIT id=Yryrcyn facing se}

                [message]
                    speaker=Yryrcyn
                    message= _ "<i>mutters</i>"
                [/message]

                {MODIFY_UNIT id=Archduke facing nw}

                [message]
                    speaker=Archduke
                    message= _ "What's that, Yryrcyn?"
                [/message]
                [role]
                    role=Ads_toadie
                    id=Yryrcyn
                [/role]
            [/else]
        [/if]

        [message]
            role=Ads_toadie
            message= _ "I said I'm right by your side."
        [/message]
        [message]
            speaker=Archduke
            message= _ "Well don't just stand there, have the men wreck that bridge!"
        [/message]

        {MOVE_UNIT (x,y=3,2) 9 4}
        {CLEAR_FOG_NOBUG 1 10 3 1}

        [message]
            role=Ads_toadie
            message= _ "<i>mutters!</i>"
        [/message]

        [role]
            role=swimmer
            side=2
            type=Horseman,Cavalryman,Knight,Sergeant,Spearman
        [/role]

        [message]
            role=swimmer
            message= _ "What did he say?"
        [/message]

        [sound]
            name=water-blast.wav
        [/sound]

        [terrain]
            x,y=10,4
            terrain=Wo
        [/terrain]

        [redraw]
        [/redraw]

        [message]
            role=Ads_toadie
            message= _ "I said, <i>stand clear!</i>"
        [/message]

        {UNCLEAR_FOG_NOBUG}
    [/event]

    [event]
        name=side 1 turn 10

        # gives movement back to Shining:
        {VARIABLE part 2}

        [modify_side]
            team_name=1
            [filter_side]
            	side=5
            [/filter_side]
            hidden=no
        [/modify_side]

        {TELEPORT_UNIT id=Shining 8 35}
        [unhide_unit]
        [/unhide_unit]

        # fix Shining's XP:
        [store_unit]
            variable=stored_shining
            [filter]
                id=Shining
            [/filter]
        [/store_unit]

        {VARIABLE stored_shining.experience $shining_experience}
        [unstore_unit]
            variable=stored_shining
        [/unstore_unit]

        {CLEAR_VARIABLE stored_shining,shining_experience}

        [sound]
            name=horse-canter.wav
        [/sound]
        [sound]
            name=fanfare-short.wav
        [/sound]

        {MOVE_UNIT id=Shining 1 23}
        {CLEAR_FOG 1 1 22 1}
        {MODIFY_UNIT id=Shining facing ne}

        [scroll_to_unit]
            id=Shining
        [/scroll_to_unit]

        {STORE_UNIT_VAR id=Archduke x archduke_x}
        {STORE_UNIT_VAR id=Archduke y archduke_y}
        {CLEAR_FOG 1 $archduke_x $archduke_y 2}
        {CLEAR_VARIABLE archduke_x,archduke_y}

        [message]
            speaker=Archduke
            message= _ "Knight Shining? You are supposed to be rotting in my dungeon!"
        [/message]

        [scroll_to_unit]
            id=Shining
        [/scroll_to_unit]

        [message]
            speaker=Shining
            message= _ "Your jailers can be bribed as easily as anyone else, my liege. How goes the battle?"
        [/message]

        [message]
            speaker=Archduke
            message= _ "Who knows? They're all mucking about in the swamp there. I may have underestimated that goblin friend of yours. Have you brought any troops with you?"
        [/message]

        [scroll_to_unit]
            id=Shining
        [/scroll_to_unit]

        [message]
            speaker=Shining
            message= _ "A few woodsmen from the outlying farms."
        [/message]
        [message]
            speaker=Archduke
            message= _ "Good show, old chap. I had no idea the woodsmen would be sympathetic to my cause."
        [/message]

        [scroll_to_unit]
            id=Shining
        [/scroll_to_unit]

        [message]
            speaker=Shining
            message= _ "They are not, my liege. And neither am I."
        [/message]

        [terrain]
            x=2-4
            y=31-32
            terrain=Ce
        [/terrain]
        [terrain]
            x,y=3,33
            terrain=Ce
        [/terrain]
        [terrain]
            x,y=3,32
            terrain=Ke
        [/terrain]

        [redraw]
        [/redraw]

        {MOVE_UNIT id=Shining 3 32}
        {UNIT 5 Woodsman 3 31 animate=yes}
        {UNIT 5 Woodsman 4 31 animate=yes}
        {UNIT 5 Woodsman 4 32 animate=yes}
        {UNIT 5 Woodsman 3 33 animate=yes}
        {UNIT 5 Woodsman 2 32 animate=yes}
        {UNIT 5 Woodsman 2 31 animate=yes}

        [message]
            speaker=Eeep
            message= _ "The humans fight for us?"
        [/message]
        [message]
            speaker=Kennison
            message= _ "All we need is a battalion of swamp yeti riding undead gryphons and this war will be complete!"
        [/message]
        [message]
            speaker=Eeep
            message= _ "But ... something Clammie is not telling Eeep?"
        [/message]
        [message]
            speaker=Clammie
            message= _ "Well --"
        [/message]
        [message]
            speaker=Eeep
            message= _ "Not someone else to protect?"
        [/message]
        [message]
            speaker=Clammie
            message= _ "Well, he does fit in very nicely with my plans."
        [/message]

        {UNCLEAR_FOG_NOBUG}

        [objectives]
            summary= _ "New Objectives:"
            [objective]
                description= _ "Defeat the Archduke"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Clammie"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Eeep"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Tikitiki"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Shining"
                condition=lose
            [/objective]
        [/objectives]
    [/event]

    # on defeat of Phillips
    [event]
        name=last breath
        [filter]
            id=Phillips
        [/filter]

        [message]
            speaker=Phillips
            message= _ "Many men have died today. There is no reason that I should too! I surrender."
        [/message]
        [message]
            speaker=Clammie
            message= _ "I leave you to the tender mercies of our mermen allies. They'll decide how to handle you."
        [/message]
        [message]
            speaker=Phillips
            message= _ "But I can't swim!"
        [/message]
        [message]
            speaker=Tikitiki
            message= _ "You shall learn."
        [/message]

        [kill]
            id=Phillips
            animate=no
            fire_event=no
        [/kill]

        [message]
            speaker=narrator
            image="wesnoth-icon.png"
            message= _ "Phillips is taken into custody by the merfolk ..."
        [/message]
    [/event]

    # on defeat of Archduke
    [event]
        name=last breath
        [filter]
            id=Archduke
        [/filter]

        [message]
            speaker=Archduke
            message= _ "The world turned upside down! I have no choice but to say, I --"
        [/message]
        [message]
            speaker=Clammie
            message= _ "Of course. You surrender. I should cut your throat, villain."
        [/message]
        [message]
            speaker=Archduke
            message= _ "But you won't, will you? You are a man of honor."
        [/message]
        [message]
            speaker=Clammie
            message= _ "No, I am a goblin of chaos. I'll accept your surrender on one condition. You must give half your lands to Knight Shining."
        [/message]
        [message]
            speaker=Archduke
            message= _ "But then he'd be as powerful as I!"
        [/message]
        [message]
            speaker=Clammie
            message= _ "That's the idea. You'll be too busy backstabbing each other to bother the rest of us."
        [/message]
        [message]
            speaker=Archduke
            message= _ "Surely we can come to a better agreement."
        [/message]
        [message]
            speaker=Clammie
            message= _ "Well, I could turn you over to the orcs and let them use your ribcage as a smokestack."
        [/message]
        [message]
            speaker=Archduke
            message= _ "You drive a hard bargain, swampling. I hereby give half my lands to Shining."
        [/message]
        [message]
            speaker=Clammie
            message= _ "And half your wealth for two projects: to rebuild Xaffrasz, and a new city here. The city of Eeep."
        [/message]
        [message]
            speaker=Eeep
            message= _ "Eeep?"
        [/message]
        [message]
            speaker=Archduke
            message= _ "That's highly irregular!"
        [/message]
        [message]
            speaker=Clammie
            message= _ "Yes, but I think you'll agree it's preferable to Grirk's smokestack policy."
        [/message]

        [if]
            [have_unit]
                id=Grirk
            [/have_unit]
            [then]
                [message]
                    speaker=Grirk
                    message= _ "Grrrr--"
                [/message]
            [/then]
            [else]
                [role]
                    role=scary_orc
                    type=Orcish Warlord,Orcish Warrior,Orcish Grunt,Orcish Slayer,Orcish Assassin,Orcish Crossbowman,Orcish Archer
                [/role]

                [message]
                    role=scary_orc
                    message= _ "Grrrr--"
                [/message]
            [/else]
        [/if]

        [message]
            speaker=Archduke
            message= _ "I consent!"
        [/message]

        {CLEAR_VARIABLE id_of_messenger,name_of_messenger,messenger,part}

        [endlevel]
            result=victory
            carryover_report=no
            {NEW_GOLD_CARRYOVER 40}
        [/endlevel]
    [/event]

    # on death of Clammie
    [event]
        name=last breath
        [filter]
            id=Clammie
        [/filter]

        [message]
            speaker=Clammie
            message= _ "A more considered approach might have been prudent."
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    # on death of Tikitiki
    [event]
        name=last breath
        [filter]
            id=Tikitiki
        [/filter]

        [message]
            speaker=Tikitiki
            message= _ "Please summon my priestess ... I am no more!"
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    # on death of Eeep
    [event]
        name=die
        [filter]
            id=Eeep
        [/filter]

        [message]
            speaker=Clammie
            message= _ "Truly, we cannot continue without Eeep!"
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    # on death of Shining
    [event]
        name=die
        [filter]
            id=Shining
        [/filter]

        [message]
            speaker=Clammie
            message= _ "Catastrophe! That scoundrel was the very center of my plan!"
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    # on death of Misris
    [event]
        name=last breath
        [filter]
            id=Misris
        [/filter]

		[if]
            [have_location]
                time_of_day=chaotic
			[/have_location]

	        [then]
		        {MODIFY_UNIT id=Misris profile "portraits/transparent/misris-night.png"}
	        [/then]
	        [else]
		        {MODIFY_UNIT id=Misris profile "portraits/transparent/misris-day.png"}
			[/else]
        [/if]

        [message]
            speaker=Misris
            message= _ "Eeep, my love! Please find the courage to continue without me."
        [/message]
        [message]
            speaker=Eeep
            message= _ "I will try, dear Misris, but it will not be easy."
        [/message]

        {VARIABLE Misris_is_dead yes}
    [/event]

    # Kennison's death
    [event]
        name=last breath
        [filter]
            id=Kennison
        [/filter]
        [message]
            speaker=Kennison
            message= _ "Rapscallion!"
        [/message]
        [message]
            speaker=Clammie
            message= _ "The humans killed our Kennison!"
        [/message]
        [message]
            speaker=Kennison
            message= _ "I am greatly ... honored to hear you put it that way ... my friend ..."
        [/message]

        {VARIABLE Kennison_is_dead yes}
    [/event]

    # Reed's death
    [event]
        name=last breath
        [filter]
            id=Reed
        [/filter]

        {VARIABLE Reed_is_dead yes}

        [message]
            speaker=Reed
            message=_"Farewell, my friends! Clammie, I never knew freedom until I met you."
        [/message]
        [message]
            speaker=Clammie
            message= _ "Rest well, loyal goblin!"
        [/message]
    [/event]

    # Grirk's death
    [event]
        name=last breath
        [filter]
            id=Grirk
        [/filter]
        [message]
            speaker=Grirk
            message= _ "Let it be written ... Warlord Grirk was the greatest and strongest of his generation!"
        [/message]
        [message]
            speaker=Kennison
            message= _ "Honestly, I think I'm the only one here who can write my name!"
        [/message]
        [message]
            speaker=Grirk
            message= _ "Let it be carved in marble, taller than the cliffs!"
        [/message]
        [message]
            speaker=Kennison
            message= _ "You really need a sense of proportionality, old chap."
        [/message]

        {VARIABLE Grirk_is_dead yes}
    [/event]

    # Hertrazzir's death
    [event]
        name=last breath
        [filter]
            id=Hertrazzir
        [/filter]
        [message]
            speaker=Hertrazzir
            message= _ "Comrades! Promise me I shall never be forgotten!"
        [/message]
        [message]
            speaker=Kennison
            message= _ "Of course, certainly ... "<span size='small'> _"what was her name?"</span>
        [/message]

        [scroll_to_unit]
            id=Hertrazzir
        [/scroll_to_unit]

        {VARIABLE Hertrazzir_is_dead yes}
    [/event]

    # Sydd's death
    [event]
        name=last breath
        [filter]
            id=Sydd
        [/filter]
        [message]
            speaker=Sydd
            message= _ "<i>mutters</i>"
        [/message]

        # TODO fix talking bats!
        [message]
            speaker=second_unit
            message= _ "What did he say?"
        [/message]
    [/event]

    [event]
        name=attacker hits
        [filter]
            id=Phillips
        [/filter]
        [message]
            speaker=Phillips
            message= _ "Taste my triple-honed glaive, varlet!"
        [/message]
    [/event]

    [event]
        name=attacker hits
        [filter]
            id=Duldursil
        [/filter]
        [filter_second]
            race=human
        [/filter_second]
        [message]
            speaker=Duldursil
            message= _ "Take that, ye briny man!"
        [/message]
    [/event]

    [event]
        name=attacker hits
        [filter_second]
            id=Um_Brok
        [/filter_second]
        [message]
            speaker=Um_Brok
            message= _ "YOU HIT UM BROK!"
            sound=troll-die-1.ogg
        [/message]
    [/event]

    [event]
        name=attacker hits
        [filter]
            id=Um_Brok
        [/filter]
        [message]
            speaker=Um_Brok
            message= _ "UM BROK HIT YOU!"
            sound=troll-die-3.ogg
        [/message]
    [/event]

    [event]
        name=last breath
        [filter_second]
            id=Misris
        [/filter_second]

		[if]
            [have_location]
                time_of_day=chaotic
			[/have_location]

	        [then]
		        {MODIFY_UNIT id=Misris profile "portraits/transparent/misris-night.png"}
	        [/then]
	        [else]
		        {MODIFY_UNIT id=Misris profile "portraits/transparent/misris-day.png"}
			[/else]
        [/if]

        [message]
            speaker=Misris
            message= _ "Farewell, coarse prince! Dream now and trouble us no more!"
        [/message]
    [/event]

    [event]
        name=last breath
        [filter_second]
            id=Grirk
        [/filter_second]
        [message]
            speaker=Grirk
            message= _ "All you puny humans will fall to the mighty Warlord Grirk, the greatest orc who ever lived!"
        [/message]
        [message]
            speaker=Eeep
            message= _ "Look at that, old buckethead finally hit someone."
        [/message]
    [/event]

    [event]
        name=attack_end
        [filter]
            side=4
        [/filter]
        [message]
            speaker=second_unit
            message= _ "Why are the mermen attacking? We have no fight with you!"
        [/message]

        # to avoid the dreaded talking bat syndrome:
        {IF_VAR unit.race equals bats (
            [then]
                [role]
                    role=irate_merfolk
                    type=Merman Fighter Sw,Merman Warrior,Merman Hunter,Mermaid Initiate,Merman Spearman
                [/role]
                [message]
                    role=irate_merfolk
                    message= _ "I'm sure you'd rather have us turn our back, so you could strike us at your convenience. We've had enough of your perfidy!"
                [/message]
            [/then]
            [else]
                [message]
                    speaker=unit
                    message= _ "I'm sure you'd rather have us turn our back, so you could strike us at your convenience. We've had enough of your perfidy!"
                [/message]
            [/else]
        )}
    [/event]

    [event]
        name=attack_end
        [filter]
            type=Merman Spearman
        [/filter]
        [message]
            speaker=unit
            message= _ "So you want war? The Merfolk will gladly oblige you!"
        [/message]
    [/event]

    [event]
        name=attack_end
        [filter]
            type=Saurian Skirmisher
        [/filter]
        [message]
            speaker=second_unit
            message= _ "Kill the skinks first! They don't look like much, but they're crafty!"
        [/message]
        [message]
            speaker=unit
            message= _ "Kill the $second_unit.type! He's a buffoon."
        [/message]
    [/event]

    [event]
        name=attack_end
        [filter]
            id=Resentment
        [/filter]
        [message]
            speaker=Resentment
            message= _ "     <i>Now it's time to say goodnight,
        You were a worthy foe,
        But dawdlers cannot elude
        Resentment's handy bow.</i>"
        [/message]
    [/event]

    [event]
        name=attack_end
        [filter]
            id=Clammie
        [/filter]
        # Duelist is last in this list because he currently has the same portrait as Kennison:
        [role]
            role=nearby_fencer
            type=Fencer,Swordsman,Bowman,Heavy Infantryman,Spearman,Sergeant,Horseman,Cavalryman,Duelist
            [not]
                id=Kennison
            [/not]
        [/role]
        [message]
            role=nearby_fencer
            message= _ "Hey look! It's Mister Blydd, the explosives guy."
        [/message]

        {STORE_UNIT_VAR id=Phillips x phillips_x}
        {STORE_UNIT_VAR id=Phillips y phillips_y}
        {CLEAR_FOG_NOBUG 1 $phillips_x $phillips_y 2}
        {CLEAR_VARIABLE phillips_x,phillips_y}

        [message]
            speaker=Phillips
            message= _ "He duped you, cretin! He is Rashki the Slayer!"
        [/message]
        [message]
            speaker=second_unit
            message= _ "Shining told me, his name is Ronry, some kind of goblin illusionist. Said he made a man vanish into thin air."
        [/message]
        [if]
            [have_unit]
                id=Resentment
            [/have_unit]
            [then]
                [message]
                    role=nearby_fencer
                    message= _ "He's got a skeleton with him!"
                [/message]
                [message]
                    id=Resentment
                    message= _ "Resentment never dies."
                [/message]
            [/then]
        [/if]
        [if]
            [have_unit]
                id=Um_Brok
            [/have_unit]
            [then]
                [message]
                    role=nearby_fencer
                    message= _ "A troll!"
                [/message]
                [message]
                    id=Um_Brok
                    message= _ "Shut up! Looking for rocks."
                    sound=troll-die-1.ogg
                [/message]
            [/then]
        [/if]
        [message]
            role=nearby_fencer
            message= _ "Orcs, skinks, and I think I see a dwarf! Gadzooks, he's got all the continent allied against us!"
        [/message]

        {STORE_UNIT_VAR id=Archduke x archduke_x}
        {STORE_UNIT_VAR id=Archduke y archduke_y}
        {CLEAR_FOG_NOBUG 1 $archduke_x $archduke_y 2}
        {CLEAR_VARIABLE archduke_x,archduke_y}

        [message]
            speaker=Archduke
            message= _ "The man who brings me that villian's head shall have ten thousand gold, and the hand of my daughter. And I'll name the new plumbing system after him."
        [/message]

        [scroll_to_unit]
            id=Clammie
        [/scroll_to_unit]

        {UNCLEAR_FOG_NOBUG}
    [/event]

    [event]
        name=last breath
        [filter_second]
            type=Woodsman
        [/filter_second]
        [message]
            speaker=second_unit
            message= _ "See? There's nothing we can't kill with forty or fifty arrows."
        [/message]
        [message]
            speaker=Shining
            message= _ "The poor sod looks like a porcupine."
        [/message]
    [/event]

    [event]
        name=attack_end
        [filter]
            id=Bort
        [/filter]
        [message]
            speaker=second_unit
            message= _ "I'm hit! How did that monster lay hands on a crossbow?"
        [/message]
        [message]
            speaker=Bort
            message= _ "The same way I'll soon lay hands on your silver brooch."
        [/message]
    [/event]

    [event]
        name=attacker hits
        [filter]
            type=Goblin Mimic
        [/filter]
        [message]
            speaker=unit
            message= _ "I curse you."
            sound="wolf-die.wav"
        [/message]
        [message]
            speaker=Clammie
            message= _ "Skandix says, more vehemence!"
        [/message]
        [message]
            speaker=unit
            message= _ "I <i>curse</i> you. I CURSE YOU!"
        [/message]
        [message]
            speaker=Kennison
            message= _ "By jove, I think he's got it."
        [/message]
    [/event]

    [event]
        name=attack_end
        [filter]
            id=Headbag
        [/filter]
        [message]
            speaker=Headbag
            message= _ "Don't cry -- you look better without nose!"
        [/message]
    [/event]

    # Augalol misses:
    [event]
        name=attacker misses
        [filter]
            id=Augalol
        [/filter]
        [filter_attack]
            range=ranged
        [/filter_attack]
        [message]
            speaker=Augalol
            message= _ "Right! Which one of ye's been dipping into me gunpowder?"
        [/message]
        [message]
            speaker=Eeep
            message= _ "Very tasty!"
        [/message]
    [/event]

    [event]
        name=attack
        [filter]
            type=Mermaid Initiate
        [/filter]

        {STORE_UNIT_VAR id=Phillips x phillips_x}
        {STORE_UNIT_VAR id=Phillips y phillips_y}
        {CLEAR_FOG_NOBUG 1 $phillips_x $phillips_y 2}
        {CLEAR_VARIABLE phillips_x,phillips_y}

        [message]
            speaker=Phillips
            message= _ "Beware the mermaids! They attack with a magical water spray!"
        [/message]
        [message]
            speaker=second_unit
            message= _ "Har har, that's rich! They attack with a magical water spray!"
        [/message]
        [message]
            speaker=unit
            message= _ "Come closer, human! I've a boon to bestow!"
        [/message]
        [message]
            speaker=second_unit
            message= _ "A boon, fair lady? What is it?"
        [/message]
        [message]
            speaker=unit
            message= _ "<i>No mercy.</i>"
        [/message]

        {UNCLEAR_FOG_NOBUG}
    [/event]

    # if Archduke is attacked by a bat, he will call for bodyguards:
    [event]
        name=attack
        [filter]
            race=bats
        [/filter]
        [filter_second]
            id=Archduke
        [/filter_second]

        [message]
            speaker=Archduke
            message= _ "Blast these bothersome bloodbats! Where are my bodyguards?"
        [/message]

        [unit]
            type=Huntsman
            side=2
            placement=leader
            animate=yes
            id=Bodyguard_One
            ai_special=guardian
        [/unit]
        [unit]
            type=Huntsman
            side=2
            placement=leader
            animate=yes
            id=Bodyguard_Two
            ai_special=guardian
        [/unit]
        [unit]
            type=Thief
            side=2
            placement=leader
            animate=yes
            id=Thief
            ai_special=guardian
            gender=female
        [/unit]

        [message]
            speaker=Archduke
            message= _ "More exasperations! Who the hell hired you?"
        [/message]
        [message]
            speaker=Thief
            message= _ "Some mumbly bloke."
        [/message]
        [message]
            speaker=Archduke
            message= _ "I specifically wanted a mage to assist in healing!"
        [/message]
        [message]
            speaker=Thief
            message= _ "Grandfather, at the rate you pay, you're lucky to have anyone."
        [/message]
        [message]
            speaker=Archduke
            message= _ "Well, one of you do something about this bat!"
        [/message]
        [message]
            speaker=Bodyguard_One
            message= _ "Of course, sir. That is our job."
        [/message]
        [message]
            speaker=Bodyguard_Two
            message= _ "Leave it to us, sir."
        [/message]
    [/event]

	#Wolf battle macro:
    [event]
        name=attack_end

		[filter]
            type=Swamp Wolf, Great Wolf, Direwolf
            side=1
        [/filter]
		[if]
            [have_location]
                time_of_day=chaotic
			[/have_location]

	        [then]
		        [message]
		            speaker=narrator
		            image="portraits/transparent/wolf-night.png"
		            message= _ "<i>$second_unit.name frequently had nightmares of being devoured by a wild beast. $unit.name often dreamed of feasting on a tasty $second_unit.type. Sometimes, dreams really do come true.</i>"
		        [/message]
	        [/then]
	        [else]
		        [message]
		            speaker=narrator
		            image="portraits/transparent/wolf-day.png"
		            message= _ "<i>$second_unit.name frequently had nightmares of being devoured by a wild beast. $unit.name often dreamed of feasting on a tasty $second_unit.type. Sometimes, dreams really do come true.</i>"
		        [/message]
	        [/else]
		[/if]
    [/event]

    {HERO_DEATHS}
[/scenario]
